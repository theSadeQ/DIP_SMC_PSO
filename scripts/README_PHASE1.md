# Task 2 — Phase 1: Structural Reorganization

This package performs **Phase 1** of the autonomous API documentation implementation for `DIP_SMC_PSO`.
It **reorganizes existing flat RST files** under `dip_docs/docs/source/api/` into a **6‑directory structure**,
and generates `index.rst` files for clean navigation.

> Source of truth: `dip_docs/docs/source/api/` (not `docs/source/api/`).

## What this does

- Creates functional folders:
  - `core/`, `controllers/`, `optimizer/`, `benchmarks/`, `fault_detection/`, `utils/`
- Moves existing `*.rst` files from the flat folder into the right subfolder (e.g. `core.adaptive_integrator.rst` → `core/adaptive_integrator.rst`).
- Renames files by **removing the package prefix** (e.g. `controllers.factory.rst` → `controllers/factory.rst`).
- Creates/updates:
  - `dip_docs/docs/source/api/index.rst` (top‑level API nav)
  - `*/index.rst` inside each subfolder with a `toctree` of local modules.
- Idempotent & safe: supports `--dry-run` to preview without changing files. Creates a backup of the original flat files list.

## DEPLOYMENT STEPS

### 1. Navigate to Project Root
The scripts must be run from the **DIP_SMC_PSO** project root directory (where `dip_docs/` exists):

```bash
cd /path/to/DIP_SMC_PSO/
```

### 2. Verify Project Structure
Ensure you're in the correct location:
```bash
ls dip_docs/docs/source/api/
# Should show flat RST files like: core.adaptive_integrator.rst, controllers.factory.rst, etc.
```

### 3. Run Reorganization

**Option A: Interactive Script (Recommended)**
```bash
bash scripts/PHASE1_APPLY.sh
```

**Option B: Direct Python Execution**
```bash
# Preview actions first
python scripts/task2_phase1_reorg.py --dry-run

# Apply changes
python scripts/task2_phase1_reorg.py

# Review results
git status
```

## VERIFICATION COMMANDS

After successful execution, verify the reorganization:

```bash
# Check directory structure
find dip_docs/docs/source/api/ -type d | sort
# Expected output:
# dip_docs/docs/source/api/
# dip_docs/docs/source/api/benchmarks
# dip_docs/docs/source/api/controllers
# dip_docs/docs/source/api/core
# dip_docs/docs/source/api/fault_detection
# dip_docs/docs/source/api/optimizer
# dip_docs/docs/source/api/utils

# Check file distribution
for dir in core controllers optimizer benchmarks fault_detection utils; do
  echo "=== $dir ==="
  ls dip_docs/docs/source/api/$dir/ 2>/dev/null || echo "  (empty or missing)"
done

# Verify index files exist
find dip_docs/docs/source/api/ -name "index.rst" | sort
# Expected: 7 index.rst files (1 main + 6 subdirectories)
```

## Success Indicators

✅ **6 subdirectories created** under `dip_docs/docs/source/api/`
✅ **21 RST files moved** from flat structure to appropriate categories
✅ **7 index.rst files** created (main + 6 subdirs)
✅ **No files lost** - all original content preserved
✅ **Clean git status** showing organized moves

## Notes / Guarantees

- **No content changes** are made to the RST files in Phase 1 — only reorganization and index generation.
- The script only touches paths under `dip_docs/docs/source/api/`.
- `logging_config.rst` (if present) is placed under `utils/`.
- Unknown prefixes (files not matching known families) are left in place and listed for Phase 2 attention.
- **Dynamic path discovery**: Script automatically locates the project root regardless of where it's placed.

## Troubleshooting

**Error: "Could not locate DIP_SMC_PSO project root"**
- Ensure you're running from within the DIP_SMC_PSO project directory
- Verify `dip_docs/docs/source/api/` exists in your project

**Error: "expected path not found"**
- Check that `dip_docs/docs/source/api/` directory exists
- Ensure you have the correct project structure

**No files moved**
- Run with `--dry-run` first to see planned actions
- Check if files are already organized (script is idempotent)

---

Generated by ChatGPT (Task 2 • Phase 1) - Fixed version with robust path resolution.